<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduBoard - Lavagna Digitale Interattiva</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="32x32" href="icon-96x96.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <meta name="theme-color" content="#2563EB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>
    <!-- Header elegante -->
    <header>
        <div class="header-left">
            <div class="logo">
                <img src="icon-96x96.png" alt="EduBoard" class="logo-icon">
                <h1>EduBoard</h1>
            </div>
            <div class="project-info">
                <span id="current-project">Nuovo Progetto</span>
            </div>
        </div>
        <div class="header-right">
            <button id="fullscreen-btn" class="header-btn" title="Schermo Intero">⛶</button>
            <button id="save-btn" class="header-btn primary" title="Salva">💾</button>
            <button id="load-btn" class="header-btn" title="Carica">📂</button>
            <button id="new-btn" class="header-btn" title="Nuovo">✨</button>
        </div>
    </header>

    <!-- Menu flottante trascinabile -->
    <!-- Barra flottante elegante -->
    <div id="floating-toolbar" class="floating-toolbar">
        <!-- Strumenti principali -->
        <div class="toolbar-item" data-tooltip="Strumenti di disegno">
            <button id="tools-btn" class="toolbar-btn active" data-panel="tools">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/>
                </svg>
            </button>
            <div id="tools-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Strumenti</h4>
                        <div class="tool-grid">
                            <button class="tool-btn active" data-tool="pencil" title="Matita">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/>
                                </svg>
                                <span>Matita</span>
                            </button>
                            <button class="tool-btn" data-tool="pen" title="Biro">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                </svg>
                                <span>Biro</span>
                            </button>
                            <button class="tool-btn" data-tool="marker" title="Evidenziatore">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M18.5,1.15L17.97,1.68L16.5,3.15L15.97,3.68L14.5,5.15L9.85,9.8C9.63,10C9.63,10.37 9.85,10.6 10.05,10.8L13.2,13.95C13.4,14.17 13.77,14.17 13.97,13.95L18.62,9.3L20.09,7.83L20.62,7.3L22.09,5.83L22.62,5.3L18.5,1.15M8.5,11L4,15.5V18.5H7L11.5,14L8.5,11M2,20.5V22.5H16V20.5H2Z"/>
                                </svg>
                                <span>Evidenziatore</span>
                            </button>
                            <button class="tool-btn" data-tool="fountain" title="Stilografica">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M16.84,2.73C16.45,2.73 16.07,2.88 15.77,3.17L13.65,5.29C13.55,5.39 13.55,5.54 13.65,5.64L18.36,10.35C18.46,10.45 18.61,10.45 18.71,10.35L20.83,8.23C21.42,7.64 21.42,6.69 20.83,6.1L17.9,3.17C17.6,2.88 17.22,2.73 16.84,2.73M12.94,6L8,10.94L9.06,12L14,7.06L12.94,6M7.23,11.65L3.86,15L5.5,16.64L8.87,13.29L7.23,11.65M3,16.5V21H7.5L16.81,11.69L12.31,7.19L3,16.5Z"/>
                                </svg>
                                <span>Stilografica</span>
                            </button>
                            <button class="tool-btn" data-tool="eraser" title="Gomma">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"/>
                                </svg>
                                <span>Gomma</span>
                            </button>
                            <button class="tool-btn" data-tool="text" title="Testo">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M18.5,4L19.66,8.35L18.7,8.61C18.25,7.74 17.79,7.87 17.26,7.87H15.11L14.57,6.8H16.3C16.6,6.8 16.8,6.69 16.8,6.39C16.8,5.88 16.69,5.27 16.69,4.67H11.31C11.31,5.27 11.2,5.88 11.2,6.39C11.2,6.69 11.4,6.8 11.7,6.8H13.43L12.89,7.87H10.74C10.21,7.87 9.75,7.74 9.3,8.61L8.34,8.35L9.5,4H18.5M9.4,9.87H14.6L12,16.13L9.4,9.87Z"/>
                                </svg>
                                <span>Testo</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-section">
                        <h4>Dimensione</h4>
                        <div class="size-selector">
                            <button class="size-btn" data-size="2"><div class="size-dot size-1"></div></button>
                            <button class="size-btn" data-size="4"><div class="size-dot size-2"></div></button>
                            <button class="size-btn active" data-size="6"><div class="size-dot size-3"></div></button>
                            <button class="size-btn" data-size="10"><div class="size-dot size-4"></div></button>
                            <button class="size-btn" data-size="15"><div class="size-dot size-5"></div></button>
                        </div>
                    </div>
                    
                    <div class="tool-section">
                        <h4>Colore</h4>
                        <div class="color-palette">
                            <button class="color-btn active" data-color="#000000" style="background: #000000"></button>
                            <button class="color-btn" data-color="#2563EB" style="background: #2563EB"></button>
                            <button class="color-btn" data-color="#DC2626" style="background: #DC2626"></button>
                            <button class="color-btn" data-color="#16A34A" style="background: #16A34A"></button>
                            <button class="color-btn" data-color="#FFEB3B" style="background: #FFEB3B"></button>
                            <button class="color-btn" data-color="#FF9800" style="background: #FF9800"></button>
                            <button class="color-btn" data-color="#9333EA" style="background: #9333EA"></button>
                            <button class="color-btn" data-color="#E91E63" style="background: #E91E63"></button>
                            <button class="color-btn" data-color="#00BCD4" style="background: #00BCD4"></button>
                            <button class="color-btn" data-color="#795548" style="background: #795548"></button>
                            <button id="custom-color" class="color-btn custom">+</button>
                        </div>
                        <input type="color" id="color-picker" style="display: none;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Strumento Mano -->
        <div class="toolbar-item" data-tooltip="Mano - Trascina oggetti">
            <button id="hand-btn" class="toolbar-btn" data-tool="hand">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13,6V8H9V6H13M15,4H7V10H15V4M12,15.5A3.5,3.5 0 0,1 8.5,12H10A2,2 0 0,0 12,14A2,2 0 0,0 14,12H15.5A3.5,3.5 0 0,1 12,15.5M12,12A1,1 0 0,1 11,11V9A1,1 0 0,1 12,8A1,1 0 0,1 13,9V11A1,1 0 0,1 12,12M8,11.5A1,1 0 0,1 7,10.5V9.5A1,1 0 0,1 8,8.5A1,1 0 0,1 9,9.5V10.5A1,1 0 0,1 8,11.5M16,11.5A1,1 0 0,1 15,10.5V9.5A1,1 0 0,1 16,8.5A1,1 0 0,1 17,9.5V10.5A1,1 0 0,1 16,11.5M12.5,2C13,2 13.5,2.17 13.79,2.46L16.54,5.21C16.83,5.5 17,6 17,6.5V10.5C17,11.33 16.33,12 15.5,12C14.67,12 14,11.33 14,10.5V10H10V10.5C10,11.33 9.33,12 8.5,12C7.67,12 7,11.33 7,10.5V6.5C7,6 7.17,5.5 7.46,5.21L10.21,2.46C10.5,2.17 11,2 11.5,2H12.5Z"/>
                </svg>
            </button>
        </div>

        <!-- Strumento Lazo -->
        <div class="toolbar-item" data-tooltip="Lazo - Seleziona e sposta oggetti">
            <button id="lasso-btn" class="toolbar-btn" data-tool="lasso">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M2,2V4H4V2H2M6,2V4H8V2H6M10,2V4H12V2H10M14,2V4H16V2H14M18,2V4H20V2H18M22,2V4H24V2H22M2,6V8H4V6H2M22,6V8H24V6H22M2,10V12H4V10H2M22,10V12H24V10H22M2,14V16H4V14H2M22,14V16H24V14H22M2,18V20H4V18H2M6,18V20H8V18H6M10,18V20H12V18H10M14,18V20H16V18H14M18,18V20H20V18H18M22,18V20H24V18H22Z"/>
                </svg>
            </button>
        </div>

        <!-- Sfondi -->
        <div class="toolbar-item" data-tooltip="Sfondi della lavagna">
            <button id="backgrounds-btn" class="toolbar-btn" data-panel="backgrounds">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
            </button>
            <div id="backgrounds-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Sfondi</h4>
                        <div class="bg-grid">
                            <button class="bg-btn active" data-bg="blank">
                                <div class="bg-preview bg-blank"></div>
                                <span>Bianco</span>
                            </button>
                            <button class="bg-btn" data-bg="lines">
                                <div class="bg-preview bg-lines"></div>
                                <span>Righe</span>
                            </button>
                            <button class="bg-btn" data-bg="squares">
                                <div class="bg-preview bg-squares"></div>
                                <span>Quadretti</span>
                            </button>
                            <button class="bg-btn" data-bg="music">
                                <div class="bg-preview bg-music"></div>
                                <span>Pentagramma</span>
                            </button>
                            <button class="bg-btn" data-bg="dots">
                                <div class="bg-preview bg-dots"></div>
                                <span>Puntini</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Geometria -->
        <div class="toolbar-item" data-tooltip="Strumenti geometrici">
            <button id="geometry-btn" class="toolbar-btn" data-panel="geometry">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L16.6,3.16L18.36,1.39L22.61,5.64L20.84,7.4L15.89,12.35L14.83,13.41L15.89,14.47L14.47,15.89L13.41,14.83L12.35,15.89L7.4,20.84L5.64,22.61L1.39,18.36Z"/>
                </svg>
            </button>
            <div id="geometry-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Strumenti Geometrici</h4>
                        <div class="geometry-tools">
                            <button id="ruler-btn" class="geometry-btn">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L16.6,3.16L18.36,1.39L22.61,5.64L20.84,7.4L15.89,12.35L14.83,13.41L15.89,14.47L14.47,15.89L13.41,14.83L12.35,15.89L7.4,20.84L5.64,22.61L1.39,18.36Z"/>
                                </svg>
                                <span>Righello</span>
                            </button>
                            <button id="protractor-btn" class="geometry-btn">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12H8A4,4 0 0,1 12,8V6Z"/>
                                </svg>
                                <span>Goniometro</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forme -->
        <div class="toolbar-item" data-tooltip="Forme geometriche">
            <button id="shapes-btn" class="toolbar-btn" data-panel="shapes">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2M6.5,12.5L8.5,16.5L4.5,16.5L6.5,12.5M17.5,12.5L19.5,16.5L15.5,16.5L17.5,12.5Z"/>
                </svg>
            </button>
            <div id="shapes-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Forme</h4>
                        <div class="shapes-grid">
                            <button class="shape-btn" data-shape="line" title="Linea">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M3,17H21L12,8L3,17Z"/>
                                </svg>
                                <span>Linea</span>
                            </button>
                            <button class="shape-btn" data-shape="rectangle" title="Rettangolo">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M3,5V19H21V5H3M5,7H19V17H5V7Z"/>
                                </svg>
                                <span>Rettangolo</span>
                            </button>
                            <button class="shape-btn" data-shape="circle" title="Cerchio">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4Z"/>
                                </svg>
                                <span>Cerchio</span>
                            </button>
                            <button class="shape-btn" data-shape="triangle" title="Triangolo">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M1,21H23L12,2L1,21Z"/>
                                </svg>
                                <span>Triangolo</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Azioni rapide -->
        <div class="toolbar-divider"></div>
        
        <div class="toolbar-item" data-tooltip="Carica file">
            <button id="upload-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Pulisci lavagna">
            <button id="clear-btn" class="toolbar-btn danger">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Annulla (Ctrl+Z)">
            <button id="undo-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Ripeti (Ctrl+Y)">
            <button id="redo-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.53,15.22L3.9,16C4.95,12.81 7.96,10.5 11.5,10.5C13.46,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Area canvas -->
    <main class="canvas-area">
        <canvas id="whiteboard" width="1920" height="1080"></canvas>
        
        <!-- Strumenti geometrici -->
        <div id="ruler" class="geometric-tool" style="display: none;">
            <div class="ruler-body">
                <div class="ruler-marks"></div>
            </div>
        </div>

        <div id="protractor" class="geometric-tool" style="display: none;">
            <div class="protractor-body"></div>
        </div>
    </main>

    <!-- Sidebar progetti -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h3>📁 I Miei Progetti</h3>
            <button id="close-sidebar" class="close-btn">✕</button>
        </div>
        <div class="sidebar-content">
            <div class="folder-structure">
                <div class="folder" data-folder="matematica">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Matematica</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
                <div class="folder" data-folder="italiano">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Italiano</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
                <div class="folder" data-folder="scienze">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Scienze</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Modal salvataggio -->
    <div id="save-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>💾 Salva Progetto</h3>
            </div>
            <div class="form-group">
                <label>Nome del progetto:</label>
                <input type="text" id="project-name" placeholder="Es: Lezione di matematica">
            </div>
            <div class="form-group">
                <label>Cartella:</label>
                <select id="project-folder">
                    <option value="matematica">Matematica</option>
                    <option value="italiano">Italiano</option>
                    <option value="scienze">Scienze</option>
                </select>
            </div>
            <div class="modal-actions">
                <button id="cancel-save" class="btn-secondary">Annulla</button>
                <button id="confirm-save" class="btn-primary">Salva</button>
            </div>
        </div>
    </div>

    <!-- File input nascosto -->
    <input type="file" id="file-input" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif" style="display: none;">

    <script src="app.js"></script>
</body>
</html>