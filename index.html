<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduBoard - Lavagna Digitale Interattiva</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="32x32" href="icon-96x96.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <meta name="theme-color" content="#2563EB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>
    <!-- Header elegante -->
    <header>
        <div class="header-left">
            <div class="logo">
                <img src="icon-96x96.png" alt="EduBoard" class="logo-icon">
                <h1>EduBoard</h1>
            </div>
            <div class="project-info">
                <span id="current-project">Nuovo Progetto</span>
            </div>
        </div>
        <div class="header-right">
            <button id="fullscreen-btn" class="header-btn" title="Schermo Intero">⛶</button>
            <button id="save-btn" class="header-btn primary" title="Salva">💾</button>
            <button id="load-btn" class="header-btn" title="Carica">📂</button>
            <button id="new-btn" class="header-btn" title="Nuovo">✨</button>
        </div>
    </header>

    <!-- Menu flottante trascinabile -->
    <!-- Barra flottante elegante -->
    <div id="floating-toolbar" class="floating-toolbar">
        <!-- Strumenti principali -->
        <div class="toolbar-item" data-tooltip="Strumenti di disegno">
            <button id="tools-btn" class="toolbar-btn active" data-panel="tools">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/>
                </svg>
            </button>
            <div id="tools-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Strumenti</h4>
                        <div class="tool-grid">
                            <button class="tool-btn active" data-tool="pencil" title="Matita">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                                    <path d="M2 2l7.586 7.586"/>
                                    <circle cx="11" cy="11" r="2"/>
                                </svg>
                                <span>Matita</span>
                            </button>
                            <button class="tool-btn" data-tool="pen" title="Biro">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                                    <circle cx="11" cy="11" r="1"/>
                                </svg>
                                <span>Biro</span>
                            </button>
                            <button class="tool-btn" data-tool="marker" title="Evidenziatore">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <rect x="7" y="7" width="3" height="9"/>
                                    <rect x="14" y="7" width="3" height="5"/>
                                </svg>
                                <span>Evidenziatore</span>
                            </button>
                            <button class="tool-btn" data-tool="fountain" title="Stilografica">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                                    <path d="M15 5l4 4"/>
                                </svg>
                                <span>Stilografica</span>
                            </button>
                            <button class="tool-btn" data-tool="eraser" title="Gomma">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 20c-2.5-2.5-7-7-7-7s-4.5 4.5-7 7c-1.5 1.5-1.5 4 0 5.5s4 1.5 5.5 0c2.5-2.5 7-7 7-7s4.5-4.5 7-7"/>
                                    <path d="M6 6l4 4"/>
                                </svg>
                                <span>Gomma</span>
                            </button>
                            <button class="tool-btn" data-tool="text" title="Testo">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="4,7 4,4 20,4 20,7"/>
                                    <line x1="9" y1="20" x2="15" y2="20"/>
                                    <line x1="12" y1="4" x2="12" y2="20"/>
                                </svg>
                                <span>Testo</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-section">
                        <h4>Dimensione</h4>
                        <div class="size-selector">
                            <button class="size-btn" data-size="2"><div class="size-dot size-1"></div></button>
                            <button class="size-btn" data-size="4"><div class="size-dot size-2"></div></button>
                            <button class="size-btn active" data-size="6"><div class="size-dot size-3"></div></button>
                            <button class="size-btn" data-size="10"><div class="size-dot size-4"></div></button>
                            <button class="size-btn" data-size="15"><div class="size-dot size-5"></div></button>
                        </div>
                    </div>
                    
                    <div class="tool-section">
                        <h4>Colore</h4>
                        <div class="color-palette">
                            <button class="color-btn active" data-color="#000000" style="background: #000000"></button>
                            <button class="color-btn" data-color="#2563EB" style="background: #2563EB"></button>
                            <button class="color-btn" data-color="#DC2626" style="background: #DC2626"></button>
                            <button class="color-btn" data-color="#16A34A" style="background: #16A34A"></button>
                            <button class="color-btn" data-color="#FFEB3B" style="background: #FFEB3B"></button>
                            <button class="color-btn" data-color="#FF9800" style="background: #FF9800"></button>
                            <button class="color-btn" data-color="#9333EA" style="background: #9333EA"></button>
                            <button class="color-btn" data-color="#E91E63" style="background: #E91E63"></button>
                            <button class="color-btn" data-color="#00BCD4" style="background: #00BCD4"></button>
                            <button class="color-btn" data-color="#795548" style="background: #795548"></button>
                            <button id="custom-color" class="color-btn custom">+</button>
                        </div>
                        <input type="color" id="color-picker" style="display: none;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Strumento Mano -->
        <div class="toolbar-item" data-tooltip="Mano - Trascina oggetti">
            <button id="hand-btn" class="toolbar-btn" data-tool="hand">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 11V6a2 2 0 0 0-4 0v5"/>
                    <path d="M14 10V4a2 2 0 0 0-4 0v6"/>
                    <path d="M10 10.5V6a2 2 0 0 0-4 0v4.5"/>
                    <path d="M6 10.5V9a2 2 0 0 0-4 0v2"/>
                    <path d="M2 11v3a8 8 0 0 0 8 8h4a8 8 0 0 0 8-8v-3"/>
                </svg>
            </button>
        </div>

        <!-- Strumento Lazo -->
        <div class="toolbar-item" data-tooltip="Lazo - Seleziona e sposta oggetti">
            <button id="lasso-btn" class="toolbar-btn" data-tool="lasso">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/>
                    <path d="M13 13l6 6"/>
                </svg>
            </button>
        </div>

        <!-- Sfondi -->
        <div class="toolbar-item" data-tooltip="Sfondi della lavagna">
            <button id="backgrounds-btn" class="toolbar-btn" data-panel="backgrounds">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <polyline points="21,15 16,10 5,21"/>
                </svg>
            </button>
            <div id="backgrounds-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Sfondi</h4>
                        <div class="bg-grid">
                            <button class="bg-btn active" data-bg="blank">
                                <div class="bg-preview bg-blank"></div>
                                <span>Bianco</span>
                            </button>
                            <button class="bg-btn" data-bg="lines">
                                <div class="bg-preview bg-lines"></div>
                                <span>Righe</span>
                            </button>
                            <button class="bg-btn" data-bg="squares">
                                <div class="bg-preview bg-squares"></div>
                                <span>Quadretti</span>
                            </button>
                            <button class="bg-btn" data-bg="music">
                                <div class="bg-preview bg-music"></div>
                                <span>Pentagramma</span>
                            </button>
                            <button class="bg-btn" data-bg="dots">
                                <div class="bg-preview bg-dots"></div>
                                <span>Puntini</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Geometria -->
        <div class="toolbar-item" data-tooltip="Strumenti geometrici">
            <button id="geometry-btn" class="toolbar-btn" data-panel="geometry">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="21" y1="10" x2="3" y2="10"/>
                    <line x1="21" y1="6" x2="3" y2="6"/>
                    <line x1="21" y1="14" x2="3" y2="14"/>
                    <line x1="21" y1="18" x2="3" y2="18"/>
                </svg>
            </button>
            <div id="geometry-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Strumenti Geometrici</h4>
                        <div class="geometry-tools">
                            <button id="ruler-btn" class="geometry-btn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="21" y1="10" x2="3" y2="10"/>
                                    <line x1="21" y1="6" x2="3" y2="6"/>
                                    <line x1="21" y1="14" x2="3" y2="14"/>
                                    <line x1="21" y1="18" x2="3" y2="18"/>
                                </svg>
                                <span>Righello</span>
                            </button>
                            <button id="protractor-btn" class="geometry-btn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2a10 10 0 1 0 10 10"/>
                                    <path d="M12 12l8-8"/>
                                    <path d="M12 12l-8-8"/>
                                </svg>
                                <span>Goniometro</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forme -->
        <div class="toolbar-item" data-tooltip="Forme geometriche">
            <button id="shapes-btn" class="toolbar-btn" data-panel="shapes">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                    <circle cx="12" cy="12" r="4"/>
                    <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"/>
                </svg>
            </button>
            <div id="shapes-panel" class="expand-panel">
                <div class="panel-content">
                    <div class="tool-section">
                        <h4>Forme</h4>
                        <div class="shapes-grid">
                            <button class="shape-btn" data-shape="line" title="Linea">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                <span>Linea</span>
                            </button>
                            <button class="shape-btn" data-shape="rectangle" title="Rettangolo">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                </svg>
                                <span>Rettangolo</span>
                            </button>
                            <button class="shape-btn" data-shape="circle" title="Cerchio">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                <span>Cerchio</span>
                            </button>
                            <button class="shape-btn" data-shape="triangle" title="Triangolo">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2l10 18H2z"/>
                                </svg>
                                <span>Triangolo</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Azioni rapide -->
        <div class="toolbar-divider"></div>
        
        <div class="toolbar-item" data-tooltip="Carica file">
            <button id="upload-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7,10 12,15 17,10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Pulisci lavagna">
            <button id="clear-btn" class="toolbar-btn danger">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3,6 5,6 21,6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                    <line x1="10" y1="11" x2="10" y2="17"/>
                    <line x1="14" y1="11" x2="14" y2="17"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Annulla (Ctrl+Z)">
            <button id="undo-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 7v6h6"/>
                    <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"/>
                </svg>
            </button>
        </div>
        
        <div class="toolbar-item" data-tooltip="Ripeti (Ctrl+Y)">
            <button id="redo-btn" class="toolbar-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 7v6h-6"/>
                    <path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3-2.3"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Area canvas -->
    <main class="canvas-area">
        <canvas id="whiteboard" width="1920" height="1080"></canvas>
        
        <!-- Strumenti geometrici -->
        <div id="ruler" class="geometric-tool advanced-ruler" style="display: none;">
            <div class="ruler-body">
                <div class="ruler-angle-display">0°</div>
                <div class="ruler-scale-controls">
                    <button class="scale-btn" data-action="zoom-out">-</button>
                    <span class="scale-display">100%</span>
                    <button class="scale-btn" data-action="zoom-in">+</button>
                </div>
                <div class="ruler-marks"></div>
                <div class="ruler-edge"></div>
            </div>
        </div>

        <div id="protractor" class="geometric-tool" style="display: none;">
            <div class="protractor-body">
                <div class="protractor-center"></div>
                <div class="protractor-marks"></div>
                <div class="protractor-angle-display">0°</div>
            </div>
        </div>
    </main>

    <!-- Sidebar progetti -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h3>📁 I Miei Progetti</h3>
            <button id="close-sidebar" class="close-btn">✕</button>
        </div>
        <div class="sidebar-content">
            <div class="folder-structure">
                <div class="folder" data-folder="matematica">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Matematica</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
                <div class="folder" data-folder="italiano">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Italiano</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
                <div class="folder" data-folder="scienze">
                    <div class="folder-header">
                        <span class="folder-icon">📁</span>
                        <span class="folder-name">Scienze</span>
                    </div>
                    <div class="folder-content"></div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Modal salvataggio -->
    <div id="save-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>💾 Salva Progetto</h3>
            </div>
            <div class="form-group">
                <label>Nome del progetto:</label>
                <input type="text" id="project-name" placeholder="Es: Lezione di matematica">
            </div>
            <div class="form-group">
                <label>Cartella:</label>
                <select id="project-folder">
                    <option value="matematica">Matematica</option>
                    <option value="italiano">Italiano</option>
                    <option value="scienze">Scienze</option>
                </select>
            </div>
            <div class="modal-actions">
                <button id="cancel-save" class="btn-secondary">Annulla</button>
                <button id="confirm-save" class="btn-primary">Salva</button>
            </div>
        </div>
    </div>

    <!-- Banner di notifica aggiornamenti -->
    <div id="update-banner" class="update-banner">
        <div class="update-content">
            <div class="update-icon">🎉</div>
            <div class="update-text">
                <strong>Nuova versione disponibile!</strong>
                <p>EduBoard è stato aggiornato con nuove funzionalità</p>
            </div>
            <button id="update-btn" class="update-btn">Aggiorna ora</button>
            <button id="dismiss-btn" class="dismiss-btn">✕</button>
        </div>
    </div>

    <!-- File input nascosto -->
    <input type="file" id="file-input" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif" style="display: none;">

    <script src="app.js"></script>
</body>
</html>